# Model Evaluation Log – Arfa Fathima

- **Project:** ADR Modeling Pipeline, Pharmedic 2025 Internship Program
- **Author:** Arfa Fathima (arfa.fathima@pharmedic.ae)
- **Date Generated:** July 26, 2025
- **Model Version:** 1.0
- **Model Type:** XGBoost Classifier with CTGAN Augmentation

---

## 1. Data Context

- **Dataset:** SIDER (Side Effect Resource)
- **Dimensions:** 1,430 drugs × 5,868 side-effect features (binary matrix).
- **Target Variable:** Presence of "Abdominal Pain" (C0000737) adverse drug reaction.
- **Preprocessing:** A subset of 300 drugs and the top 100 most frequent side effects were used for the final model training and evaluation to ensure computational efficiency.

---

## 2. Sample Prediction Output

The following output was generated by `predict_model.py` using a randomly generated sample input profile.



--- ADR Prediction for Sample Drug Profile ---
Sample Input Shape: (1, 100)

Prediction:

Numeric Output: 0

Predicted Label: Abdominal Pain Not Present

Prediction Probabilities:

P(Not Present): 0.9987

P(Present):     0.0013


---

## 3. Performance Metrics on Hold-Out Test Set

The model was evaluated on the real (non-synthetic) subset of 300 drugs, which served as the hold-out test set.

- **Accuracy:** 1.00
- **Precision (class 1 - Abdominal Pain Present):** 1.00
- **Recall (class 1 - Abdominal Pain Present):** 1.00
- **F1 Score (class 1 - Abdominal Pain Present):** 1.00
- **Test Data Source:** The evaluation was performed on the `X_ct` and `y_ct` variables from the notebook, representing the 300-drug real subset.

---

## 4. Key Findings & Observations

- **Training Strategy:** The model was trained on a balanced dataset created by combining real negative samples with a mix of real and CTGAN-generated synthetic positive samples. This data augmentation strategy was crucial for addressing the class imbalance in the original dataset and achieving high performance.

- **Model Explainability (SHAP Analysis):** SHAP analysis was used to interpret the model's predictions. It identified the top side effects that most significantly drive the prediction of "Abdominal Pain." These drivers included clinically plausible gastrointestinal and systemic ADRs, which helps to validate the model's behavior against existing domain knowledge.

- **Performance Note:** The perfect accuracy score on the evaluation set indicates that the model learned the patterns within this specific 300-drug subset extremely well. However, it is important to note that performance might differ on a completely new, external dataset. The result confirms the benefit of the chosen pipeline, including PCA preprocessing and synthetic data augmentation.

## 5. Reproducibility

To reproduce this result, follow these steps:
1.  Run the `Arfa_adr_modeling_updated.ipynb` notebook to train the model and save it as `adr_model_xgboost.joblib`.
2.  Ensure the `meddra_all_se.tsv` dataset is in the root directory.
3.  Execute the `predict_model.py` script to see both a sample prediction and the full evaluation report printed to the console.